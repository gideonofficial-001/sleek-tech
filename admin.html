<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sleek Tech Admin Panel</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>

<h1 class="title">Admin Dashboard</h1>

<div class="table-box">
    <table>
        <thead>
            <tr>
                <th>Full Name</th>
                <th>Message</th>
                <th>Time</th>
            </tr>
        </thead>
        <tbody id="messagesTable"></tbody>
    </table>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: import.meta.env.FIREBASE_API_KEY,
  authDomain: import.meta.env.FIREBASE_AUTH_DOMAIN,
  projectId: import.meta.env.FIREBASE_PROJECT_ID,
  storageBucket: import.meta.env.FIREBASE_STORAGE_BUCKET,
  messagingSenderId: import.meta.env.FIREBASE_MSG_SENDER,
  appId: import.meta.env.FIREBASE_APP_ID
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

async function loadMessages() {
    const table = document.getElementById("messagesTable");
    table.innerHTML = "";

    const q = query(collection(db, "messages"), orderBy("time", "desc"));
    const snapshot = await getDocs(q);

    snapshot.forEach(doc => {
        const data = doc.data();

        const row = `
            <tr>
                <td>${data.fullname}</td>
                <td>${data.message}</td>
                <td>${new Date(data.time.seconds * 1000).toLocaleString()}</td>
            </tr>
        `;
        table.innerHTML += row;
    });
}

loadMessages();
</script>

</body>
</html>